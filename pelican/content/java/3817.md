Title: Java回调函数的理解
Date: 1970-01-01 00:00:00
Modified: 1970-01-01 00:00:00
cat: java
Tags: 
Slug: 3817
Authors: u0mo5 
Summary: 

  所谓回调，就是客户程序C调用服务程序S中的某个函数A，然后S又在某个时候反过来调用C中的某个函数B，对于C来说，这个B便叫做回调函数。例如Win32下的窗口过程函数就是一个典型的回调函数。一般说来，C不会自己调用B，C提供B的目的就是让S来调用它，而且是C不得不提供。由于S并不知道C提供的B姓甚名谁，所以S会约定B的接口规范（函数原型），然后由C提前通过S的一个函数R告诉S自己将要使用B函数，这个过程称为回调函数的注册，R称为注册函数。Web Service以及Java的RMI都用到回调机制，可以访问远程服务器程序。
    下面举个通俗的例子：    某天，我打电话向你请教问题，当然是个难题，^_^，你一时想不出解决方法，我又不能拿着电话在那里傻等，于是我们约定：等你想出办法后打手机通知我，这样，我就挂掉电话办其它事情去了。过了XX分钟，我的手机响了，你兴高采烈的说问题已经搞定，应该如此这般处理。故事到此结束。这个例子说明了“异步+回调”的编程模式。其中，你后来打手机告诉我结果便是一个“回调”过程；我的手机号码必须在以前告诉你，这便是注册回调函数；我的手机号码应该有效并且手机能够接收到你的呼叫，这是回调函数必须符合接口规范。
 
    通过上面个人感觉到回调更多的应用就是结合异步。比如：Ajax中js通过组件和服务器的异步通信。
 
例：
    程序员A写了一段程序（程序a），其中预留有回调函数接口，并封装好了该程序。程序员B要让a调用自己的程序b中的一个方法，于是，他通过a中的接口回调自己b中的方法。目的达到。在C/C++中，要用回调函数，被掉函数需要告诉调用者自己的指针地址，但在JAVA中没有指针，怎么办？我们可以通过接口（interface）来实现定义回调函数。     假设我是程序员A，以下是我的程序a：
 



[java] view plaincopyprint?
 





public class Caller  
{  
    public MyCallInterface mc;  

  
    public void setCallfuc(MyCallInterface mc)  

    {  
       this.mc= mc;  

    }  
  
    public void call(){  

       this.mc.method();  

    }  
}      




  
 
 
     我还需要定义一个接口，以便程序员B根据我的定义编写程序实现接口。



[java] view plaincopyprint?
 





public interface MyCallInterface  
{  
    public void method();  

  
}  



 
 
     于是，程序员B只需要实现这个接口就能达到回调的目的了：



[java] view plaincopyprint?
 





public class B implements MyCallInterface  
{  
    public void method()  

    {  
       System.out.println("回调");  

    }  
  
    public static void main(String args[])  

    {  
       Caller call = new Caller();  

       call.setCallfuc(new B());  

       call.call();  
    }  
}



 
