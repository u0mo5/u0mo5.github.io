Title: Windows与Linux/Mac系统时间不一致的解决方法
Date: 1970-01-01 00:00:00
Modified: 1970-01-01 00:00:00
cat: windows
Tags: 
Slug: 4152
Authors: u0mo5 
Summary: 


Windows与Linux/Mac系统时间不一致的解决方法

分类： linux2012-02-12 14:25 1691人阅读 评论(1) 收藏 举报

windowsubuntusystemlinux存储网络


转自：http://blog.sina.com.cn/s/blog_6204ca300100j4i1.html   
 世界协调时间(Universal Time Coordinated,UTC),GPS 系统中有两种时间区分，一为UTC，另一为LT（地方时）两者的区别为时区不同，UTC就是0时区的时间，地方时为本地时间，如北京为早上八点（东八区），UTC时间就为零点，时间比北京时晚八小时，以此计算即可.
UTC相当于本初子午线(即经度0度)上的平均太阳时，过去曾用格林威治平均时(GMT)来表示.北京时间比UTC时间早8小时，以1999年1月1日0000UTC为例，UTC时间是零点，北京时间为1999年1月1日早上8点整。
    GMT(Greenwich Mean Time)是格林尼治平时：由于地球轨道并非圆形，其运行速度又随着地球与太阳的距离改变而出现变化，因此视太阳时欠缺均匀性。视太阳日的长度同时亦受到地球自转轴相对轨道面的倾斜度所影响。为着要纠正上述的不均匀性，天文学家计算地球非圆形轨迹与极轴倾斜对视太阳时的效应。平太阳时就是指经修订后的视太阳时。在格林尼治子午线上的平太阳时称为世界时(UT0)，又叫格林尼治平时(GMT)。
    由于两个系统设定时间时以主板CMOS内的时间为依据，但却有不同的时间计算标准。所以导致了系统时间的纠纷问题。
    Linux和苹果操作系统以当前主板CMOS内时间做为格林威治标准时间，再根据系统设置的时区来最终确定当前系统时间（如时区设置为GMT+08:00北京时间时以及当前CMOS时间为03:00，那么系统会将两个时间相加得出显示在桌面的当前系统时间为11:00）。
    Windows 操作系统却直接把CMOS时间认定为当前显示时间，不根据时区转换。这样每调整一次系统时区，系统会根据调整的时区来计算当前时间，确定后，也就同时修改了CMOS内的时间（即每调整一次时区，设置保存后，CMOS时间也将被操作系统改变一次，注意不同操作系统调整时间后，也会同时改变CMOS时间，这一点是共通的）。

    这里我们且不论两种时间计算标准的好差，而仅让Windows认定CMOS时间为格林威治标准时间来消除操作系统之间认定时间的差异，从而解决Windows操作系统与不同操作系统并存时出现的时间矛盾。
也就是说，UTC即Universal Time Coordinated，协调世界时，GMT即Greenwich Mean Time，格林尼治平时，在这里，你可以把UTC认为是GMT+0。
    Windows(XP和VISTA)和(Linux/Unix/Mac)缺省看待系统硬件时间的方式是不一样的：
  * Windows把系统硬件时间当作本地时间(local time)，即操作系统中显示的时间跟BIOS中显示的时间是一样的。
  * Linux/Unix/Mac把硬件时间当作UTC，操作系统中显示的时间是硬件时间经过换算得来的，比如说北京时间是GMT+8，则系统中显示时间是硬件时间+8。
    这样，当PC中同时有多系统共存时，就出现了问题。假如你的Ubuntu和WindowsXP中设置的时区都为北京时间东八区，而你在Ubuntu中把当前系统时间更改为9：00AM。则此时硬件中存储的实际是UTC时间1:00AM。这时你重启进入Windows后，你会发现windows系统中显示的时间是1:AM，比Ubuntu中慢了八个小时。同理，你在Windows中更改或用网络同步了系统时间后，再到Ubuntu中去看，系统就会快了8小时。在实行夏令时的地区，情况可能会更复杂些。原因知道了，那怎么来解决这种冲突呢。一种就是让Windows把硬件时间当作UTC，与Linux/Unix/Mac保持一致。另一种就是让Linux/Unix/Mac把系统时间当作本地时间，与Windows保持一致。 
 
那么在Windows下的修改方法如下：
即在HKEY_LOCAL_MACHINESYSTEMCurrentControlSetControlTimeZoneInformation中添加一项数据类型为REG_DWORD，名称为RealTimeIsUniversal，值设为1。
也可用以下命令行：
@echo off
color 0a
Reg add HKLMSYSTEMCurrentControlSetControlTimeZoneInformation /v RealTimeIsUniversal /t REG_DWORD /d 1
echo.
echo 已让Windows识别存贮在主板CMOS内的时间为格林威治标准时间（GMT）,即系统根据CMOS时间和设置的时区来确定当前系统的时间。
echo.
pause
 
而在Ubuntu下的修改方法如下：
Ubuntu中不使用UTC时间，而启用本地时间，需要修改 /etc/default/rcS ，修改动作如下：
# 注释掉原来的设定：UTC=yes
# 变更为下面的内容...
UTC=no
 
而对于Mac，把系统的时区设为“格林尼治”时间，就是零时区就好了。


