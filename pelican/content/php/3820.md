Title: 树莓派学习笔记——Restful服务 采用slim php apache
Date: 1970-01-01 00:00:00
Modified: 1970-01-01 00:00:00
cat: php
Tags: 
Slug: 3820
Authors: u0mo5 
Summary: 

0.前言
&nbsp; &nbsp; 前些时间沉迷于Restful，采用PHP+Slim+MySQL实现了一些简单的API函数。但是这些工作都是在windows中实现（采用wamp server集成安装包），但是转到linux中还确实有些不一样，下面就使用树莓派尝试一把。
&nbsp;
1.安装php和apache2
&nbsp; &nbsp; 在这里仅安装php和apache2，如果需要安装mysql请再增加php5-mysql和mysql-server
&nbsp; &nbsp; sudo apt-get update
&nbsp; &nbsp; sudo apt-get install apache2 php
&nbsp; &nbsp;&nbsp;
2.配置apache2
&nbsp;&nbsp;&nbsp; 【为什么配置apache】
&nbsp; &nbsp; 需要打开apache中的url重定向功能，例如api/leds/1，请示并不存在该文件，而是通过响应的代码生成响应。默认情况下，apache关闭了url重定向功能，所有才有了以下的设备。
&nbsp; &nbsp; 关于windows中的设置请查看博文——【PHP再学习4—— slim框架学习和使用】
&nbsp; &nbsp; 【目录说明】
&nbsp; &nbsp; 若使用wamp server集成安装包，那么apache2相关配置文件位于wamp安装目录inapacheApache2.4.4conf
&nbsp; &nbsp; 若在linux环境配置文件就显得有些不一样了，配置文件位于&nbsp;/etc/apache2，文件名为apache2.conf
&nbsp; &nbsp;&nbsp;配置文件并不是有一个文件组成，还包括该目录下其他文件夹下的配置文件。
&nbsp; &nbsp;&nbsp;

&nbsp;&nbsp;&nbsp; 【1】使能mode_rewirte
&nbsp; &nbsp;&nbsp;sudo a2enmod rewrite
&nbsp; &nbsp;&nbsp;【2】修改配置文件 使用.htaccess文件
&nbsp; &nbsp; 配置文件位于/etc/apache2/sites-available，文件名为default。
&nbsp; &nbsp; 在&lt;Directory /var/www/&gt;设置中，原定为AllowOverride None，意为不使用.htaccess文件，可修改为AllowOverride FileInfo，意为使用.htaccess中的相关设置。
&nbsp; &nbsp;&lt;Directory /var/www/&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Options Indexes FollowSymLinks MultiViews
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # changed from None to FileInfo
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;AllowOverride FileInfo
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Order allow,deny
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; allow from all
&nbsp; &nbsp; &lt;/Directory&gt;
&nbsp; &nbsp; 【3】重启Apache

&nbsp; &nbsp;&nbsp;sudo service apache2 restart
&nbsp;
3.安装slim
&nbsp; &nbsp; 安装的具体方法有很多，这里就说说其中的一种。
&nbsp; &nbsp; 【使用Git克隆文件】
&nbsp; &nbsp; 可在home下建立一个临时文件，例如slim_temp(mkdir slim_temp)
&nbsp; &nbsp; CD至该目录，输入以下指令
&nbsp;&nbsp;&nbsp; git clone&nbsp;https://github.com/codeguy/Slim

&nbsp; &nbsp;&nbsp;【复制文件到/var/www/ 目录】
&nbsp; &nbsp; 把index.php文件，Slim文件夹和.htaccess文件 拷贝到/var/www/目录
&nbsp; &nbsp; 请注意/var/www/目录的所有者为root，复制前可修改该目录的所有者为pi
&nbsp; &nbsp;&nbsp;sudo chown -R pi /var/www
&nbsp; &nbsp; &nbsp;
4.简单的测试
&nbsp; &nbsp; 使用火狐浏览器中的HTTPRequest工具，POST方法。
&nbsp; &nbsp;

图1 发送POST请求
5.总结
&nbsp; &nbsp; 虽然树莓派做Http server能力有限，但是过程非常有趣。通过过程学习了很多apache2配置的知识。
&nbsp;
6.参考资料
1.【ubuntu apache2安装和卸载】
2.【How to enable mod_rewrite in Apache】
