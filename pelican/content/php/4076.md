Title: 使用php作linux自动执行脚本
Date: 1970-01-01 00:00:00
Modified: 1970-01-01 00:00:00
cat: php
Tags: 
Slug: 4076
Authors: u0mo5 
Summary: 


使用php作linux自动执行脚本
［来源］ 达内    ［编辑］ 达内   ［时间］2013-03-21


在作社区时, 时常需要统计上线人数等数据. 一般做法是, 把这段代码放在用户 login或者某一个页面中, 以便在用户登录或访问到该时,触发运行该代码. 这样 一来, 会造成一个问题, 如果该代码教复杂, 明显减慢该页的正常调用速度.
 
　　最近在用PHP(PHP培训 php教程 )作一社区, 在写到计算最高上线人数时, 成功调试出把PHP作为 shell script直接在服务器上运行.
　　在作社区时, 时常需要统计上线人数等数据. 一般做法是, 把这段代码放在用户 login或者某一个页面中, 以便在用户登录或访问到该时,触发运行该代码. 这样 一来, 会造成一个问题, 如果该代码教复杂, 明显减慢该页的正常调用速度.
　　利用PHP 的这种特性,加上linux(linux教程 linux培训 )的crontab指令,即可自动定时执行某一个php文 件(统计在线人数等).
　　具体方法:
　　在安装PHP的时候,会产生一个可执行文件,文件名为php.将它它 copy 到 /usr/local/bin 下.
　　在终端方式执行php程序: php -q onlinnum.php
　　注意到 PHP 原本是应用在网页应用的﹐因此它内定会送出 HTML 的 HEADER﹐但 是在此我们是要将 PHP 用作 Shell Script﹐"-q" 就是表示不要送 出 HEADER 的意思.你可以试试看不加上 -q 的显示结果。
　　此时你已经可以在终端方式下执行PHP 代码了. 呵呵,可以试试执行你以前写的 代码.
　　linux命令:cron daemon
　　这是一个系统中常驻的服务，功能在于执行例行性的工作，如每天一次或每月一 次检查磁盘。cron daemon 会在每分钟检查一次排定的工作表(crontab)，看 看是否有要执行的指令，所有的输出会以mail寄给用户。
　　设置 crontab
　　命令：crontab -e
　　该命令呼叫vi编辑器来编辑执行的清单。例如
　　&amp;nbs p; 0 0 1,15 * * fsck /home
　　&amp;nbs p; 1 * * * * /home/Gull/onlinnumber
　　每一行代表一项排定的工作

