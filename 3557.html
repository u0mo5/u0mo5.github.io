<!DOCTYPE html>
<html lang="english">
<head>

        <title>让AUTOIT自动帮我更新文件服务器上的一些常用软件</title>
        <meta charset="utf-8" />


        <!-- Mobile viewport optimized: j.mp/bplateviewport -->
        <meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1">

        <link rel="stylesheet" type="text/css" href="/theme/gumby.css" />
        <link rel="stylesheet" type="text/css" href="/theme/style.css" />
        <link rel="stylesheet" type="text/css" href="/theme/pygment.css" />

        <script src="/theme/js/libs/modernizr-2.6.2.min.js"></script>




</head>

<body id="index" class="home">


    <div class="container">

        <div class="row">

          <header id="banner" class="body">
                  <h1><a href="/">读书圈博客 <strong></strong></a></h1>
          </header><!-- /#banner -->

            <div id="navigation" class="navbar row">
              <a href="#" gumby-trigger="#navigation &gt; ul" class="toggle"><i class="icon-menu"></i></a>
             
              <ul class="columns">
                <li><a href="/">Home</a></li>


              </ul>
            </div>

<section id="content" class="body">

   <div class="row">
        <div class="eleven columns">


            <header>
              <h2 class="entry-title">
                <a href="/3557.html" rel="bookmark"
                   title="Permalink to 让AUTOIT自动帮我更新文件服务器上的一些常用软件">让AUTOIT自动帮我更新文件服务器上的一些常用软件</a></h2>
           
            </header>
            <footer class="post-info">
              <abbr class="published" title="1970-01-01T00:00:00+08:00">
                Thu 01 January 1970
              </abbr>
              <address class="vcard author">By 
                <a class="url fn" href="/author/u0mo5.html"> u0mo5</a>
              </address>
            </footer><!-- /.post-info -->
            <div class="entry-content">
              <p>要解决的问题:
 
一个朋友的公司(上班时间员工均无外网)最近全部员人都安装上了360安全卫士,补丁在局域网内升级...但360主程序在没有外网的情况下是不能升级的.....需要朋友经常去360官方下载,然后放在文件服务器上....
 
           天,这种活,干一次两次,还行,要是让你连续一年两年去保持这个程序的更新...想想后果吧.................................
 
解决方法:
为了解决这个问题: 我们利用autoit很容易搞定:
以下是源程序部分:</p>
<h1>cs ＿＿＿＿＿＿</h1>
<p>脚本作者: boyhong Email:    zhanghong1#ceri.com.cn
 QQ/TM:  184661031 脚本功能: 可靠地自动下载360到指定位置</p>
<h1>ce ＿＿＿＿＿＿</h1>
<p>$dir = IniRead("updater.ini", "PATH", "Updatepath", "")
;读取配置文件updater.ini中PATH字段Updatepath关键字中的值给$dir While ($dir = "")
;若$dir的值为空做如下提示并提示你让选择一个路径最终写进updater.ini MsgBox(0, "Welcome-by boyhong", "如果这是您第一次配置该程序，请选择软件下载后的存放文件夹"&amp;@LF&amp;"以后也可以自行更改updater.ini文件中的路径，或者清空updater.ini文件的内容并重新运行程序来选择文件夹") $dir = FileSelectFolder("请选择升级文件路径", "", 1) If ($dir &lt;&gt; "") Then IniWrite("updater.ini", "PATH", "Updatepath", $dir) EndIf WEnd InetGet("http://down.360safe.com/360compkill.zip", "360compkill.zip", 1, 1)
;下载360compkill.zip While @InetGetActive TrayTip("第一个任务:正在下载360compkill", "已下载字节数 " &amp; @InetGetBytesRead, 10, 16) Sleep(500) WEnd InetGet("http://down.360safe.com/setup.exe", "setup.exe", 1, 1)
;下载360安全卫士 While @InetGetActive TrayTip("第二个任务:正在下载360安全卫士最新正式版", "已下载字节数 " &amp; @InetGetBytesRead, 10, 16) Sleep(500) WEnd InetGet("http://down.360safe.com/offlinepackv4.exe", "offlinepackv4.exe", 1, 1)
;下载360木马特征库
  While @InetGetActive TrayTip("第三个任务:正在下载360安全卫士v4.X特征库升级包", "已下载字节数 " &amp; @InetGetBytesRead, 10, 16) Sleep(500) WEnd $sizecompkill = InetGetSize("http://down.360safe.com/360compkill.zip") $sizecompload = FileGetSize(@ScriptDir&amp;"360compkill.zip")
;获得远程及本机360compkill.zip的大小
If($sizecompkill = $sizecompload) Then
;判断，若大小一致则拷贝到指定位置，否则删除； FileCopy( @ScriptDir&amp; "360compkill.zip", $dir&amp; "360compkill.zip",1) Else FileDelete ( @ScriptDir&amp; "360compkill.zip" ) EndIf $size360 = InetGetSize("http://down.360safe.com/setup.exe") $size360load = FileGetSize(@ScriptDir&amp;"setup.exe")
;同上解释，对刚才下载的三个文件作判断。 If($size360 = $size360load) Then FileCopy( @ScriptDir&amp; "setup.exe", $dir&amp; "setup.exe",1) Else FileDelete ( @ScriptDir&amp; "setup.exe" ) EndIf $sizeoffline = InetGetSize("http://down.360safe.com/offlinepackv4.exe") $offlineload = FileGetSize(@ScriptDir&amp;"offlinepackv4.exe") If($sizeoffline = $offlineload) Then FileCopy( @ScriptDir&amp; "offlinepackv4.exe", $dir&amp; "offlinepackv4.exe",1) Else FileDelete (@ScriptDir&amp; "offlinepackv4.exe") EndIf Exit</p>
<p>将其生成一个比如:  360.exe  然后找台有外网的计算机或者服务器,通过系统的"任务计划",挂在比如每天中午12:00去执行本程序.是不是很方便?
 
 </p>
            </div><!-- /.entry-content -->


        </div><!-- /.eleven.columns -->

<div class="three columns">

<h4>Pages</h4>

 <ul>
  </ul>

<h4>Categories</h4>
<ul class="blank">
		<li><a href="/category/default.html">default</a></li>
		<li><a href="/category/java.html">java</a></li>
		<li><a href="/category/javascript.html">javascript</a></li>
		<li><a href="/category/linux.html">linux</a></li>
		<li><a href="/category/mysql.html">mysql</a></li>
		<li><a href="/category/php.html">php</a></li>
		<li><a href="/category/python.html">python</a></li>
		<li><a href="/category/windows.html">windows</a></li>
</ul>


<h4>Tags</h4>


<nav class="widget">
  <h4>Social</h4>
  <ul class="blank">
    <li><a href="http://bookfuns.com">读书圈</a></li>
    <li><a href="http://123.bookfuns.com">网址大全</a></li>
  </ul>
</nav>

</div> </div><!-- /.row -->


</section>

       </div><!-- /.row -->
    </div><!-- /.container -->


       <div class="container.nopad bg">

    
        <footer id="credits" class="row">
          <div class="seven columns left-center">

                   <address id="about" class="vcard body">
                    Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                    which takes great advantage of <a href="http://python.org">Python</a>.
                    <br />
                    Based on the <a target="_blank" href="http://gumbyframework.com">Gumby Framework</a>
                    </address>
          </div>


          <div class="seven columns">
            <div class="row">
              <ul class="socbtns">





              </ul>
            </div>
          </div>
        </footer>

    </div>


  <script src="/theme/js/libs/jquery-1.9.1.min.js"></script>
  <script src="/theme/js/libs/gumby.min.js"></script>
  <script src="/theme/js/plugins.js"></script>
</body>
</html>