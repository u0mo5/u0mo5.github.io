<!DOCTYPE html>
<html lang="zh_cn">
<head>

        <title>Windows 下使用 GNUstep 编译并运行 Objective-C 程序</title>
        <meta charset="utf-8" />


        <!-- Mobile viewport optimized: j.mp/bplateviewport -->
        <meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1">

        <link rel="stylesheet" type="text/css" href="/blog/theme/gumby.css" />
        <link rel="stylesheet" type="text/css" href="/blog/theme/style.css" />
        <link rel="stylesheet" type="text/css" href="/blog/theme/pygment.css" />

        <script src="/blog/theme/js/libs/modernizr-2.6.2.min.js"></script>




</head>

<body id="index" class="home">


    <div class="container">

        <div class="row">

          <header id="banner" class="body">
                  <h1><a href="/blog/">逍遥の博客 <strong></strong></a></h1>
          </header><!-- /#banner -->

            <div id="navigation" class="navbar row">
              <a href="#" gumby-trigger="#navigation &gt; ul" class="toggle"><i class="icon-menu"></i></a>
             
              <ul class="columns">
                <li><a href="/blog/">首页</a></li>


              </ul>

            </div>

<section id="content" class="body">

   <div class="row">
        <div class="eleven columns">


            <header>
              <h2 class="entry-title">
                <a href="/blog/4198.html" rel="bookmark"
                   title="Permalink to Windows 下使用 GNUstep 编译并运行 Objective-C 程序">Windows 下使用 GNUstep 编译并运行 Objective-C 程序</a></h2>
           
            </header>
            <footer class="post-info">
              <abbr class="published" title="1970-01-01T00:00:00+08:00">
                Thu 01 January 1970
              </abbr>
              <address class="vcard author">By 
                <a class="url fn" href="/blog/author/u0mo5.html"> u0mo5</a>
              </address>
            </footer><!-- /.post-info -->
            <div class="entry-content">
              <p>今晚上开始看《Objective-C 程序设计(第4版)》这本书（OSChina 正在做此书的书评活动，详情请看这里），到现在为止看到第 7 章，于是想动手试试写两简单的程序编译跑跑看。
不习惯 Mac，在 Windows 下装了个 GNUstep 也可以玩。
非常简单的几步，你也来试试吧？
1. 下载并安装 GNUstep
下载地址：http://ftpmain.gnustep.org/pub/gnustep/binaries/windows/
有三个文件是必须安装的，分别是：</p>
<p>gnustep-devel-1.4.0-setup.exe </p>
<p>gnustep-core-0.31.0-setup.exe </p>
<p>gnustep-msys-system-0.30.0-setup.exe </p>
<p>这里我下载的都是最新的版本，按默认方式将上面三个程序都安装在同一个目录，我用的是 D:GNUstep 目录。
安装完毕后，打开：开始菜单 -&gt; 所有程序 -&gt; GNUstep -&gt; Shell  就会进入一个类似 Linux 的 Shell 环境，如下图所示：</p>
<p>你可以自行一些简单的 Linux 命令，例如 ls、mkdir 等。
下面我们进入 /home 目录，然后创建一个 app1 的子目录：</p>
<p>?</p>
<p>1
2
3</p>
<p>cd /home</p>
<p>mkdir app1</p>
<p>cd app1</p>
<p>这个 app1 的目录位于磁盘上的 D:GNUstepmsys1.0homeapp1 目录下。
接下来我们写一个简单的程序：</p>
<p>?</p>
<p>1
2
3
4
5
6
7
8
9
10</p>
<h1>import &lt;Foundation/Foundation.h&gt;</h1>
<p>int main (int argc, const char *argv[]) {</p>
<p>//@autoreleasepool {</p>
<p>NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];</p>
<p>NSLog(@"Hello oschina");</p>
<p>[pool drain];</p>
<p>//}</p>
<p>return 0;</p>
<p>}</p>
<p>说明：由于 GNUstep 带的 gcc 编译器不支持 Objective-C 2.0 ，因此不支持 @autoreleasepool 这个指令，我将它注释掉了。
然后我们用下面的命令来编译这个程序：</p>
<p>?</p>
<p>1</p>
<p>$ gcc -o app1 app1.m -I/GNUstep/System/Library/Headers -fconstant-string-class=NSConstantString -L/GNUstep/System/Library/Libraries -lobjc -lgnustep-base</p>
<p>上面这个命令除了 -o 后面的参数你可以更改，其他都必须照写，否则就会出错。
参数说明，如果熟悉Linux/Unix下C/C++编译的话，上述参数应该很熟悉，-I表示头文件查找的路径，-L表示库文件查找 路径，-l表示需要链接的库文件。但是，-fconstant-string-class=NSConstantString  对于这个参数可能比较陌生，这个参数主要是指定常量字符串所使用的class。
编译完就会在当前目录生成一个名为 app1.exe 的可执行程序。
输入 ./app1.exe 命令执行这个程序，执行结果：
2012-11-21 22:04:46.911 app1[4780] Hello oschina
就这么简单！至于代码中每一行的意思大家自己看书吧。
再来一个复杂一点的程序 app2，app2 包含三个文件，分别是：
Main.m:</p>
<p>?</p>
<p>1
2
3
4
5
6
7
8
9
10
11
12
13
14</p>
<h1>import "Calculate.h"</h1>
<p>int main(int argc, char *argv[])</p>
<p>{</p>
<p>NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init]; </p>
<p>Calculate *cal = [[Calculate alloc] init];</p>
<p>int v = 5;</p>
<p>int av = 10;</p>
<p>[cal setNum: v];</p>
<p>[cal add: av];</p>
<p>NSLog(@"%i + %i = %i
", v, av, [cal num]);</p>
<p>[pool drain];</p>
<p>return 0;</p>
<p>}</p>
<p>Calculate.h:</p>
<p>?</p>
<p>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15</p>
<p>//Calculate.h</p>
<h1>import &lt;Foundation/Foundation.h&gt;</h1>
<p>@interface Calculate : NSObject
{</p>
<p>@private int num;</p>
<p>}
 </p>
<p>-(int) num;</p>
<p>-(void) setNum: (int) n;</p>
<p>-(void) add: (int) n;</p>
<p>@end</p>
<p>Calculate.m:</p>
<p>?</p>
<p>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20</p>
<h1>import "Calculate.h"</h1>
<p>@implementation Calculate
 </p>
<p>-(int) num</p>
<p>{</p>
<p>return num;</p>
<p>}
 </p>
<p>-(void) setNum: (int) n</p>
<p>{</p>
<p>num = n;</p>
<p>}
 </p>
<p>-(void) add: (int) n</p>
<p>{</p>
<p>num += n;</p>
<p>}
 
@end</p>
<p>编译方法更上面一样，只不过需要将两个 .m 文件都加进去：</p>
<p>?</p>
<p>1</p>
<p>$ gcc -o app2 Main.m Calculate.m -I/GNUstep/System/Library/Headers -fconstant-string-class=NSConstantString -L/GNUstep/System/Library/Libraries -lobjc -lgnustep-base</p>
<p>运行结果： 2012-11-21 22:17:51.207 app2[3144] 5 + 10 = 15
现在的问题是：有没有办法让 GNUstep 支持 Objective-C 2.0 呢？官网上有描述这个问题，需要使用Clang 编译器，不知道如何搞定！
 
 
 </p>
<p>Windows系统中使用GNUstep 编译运行Objective-C程序
 (2011-03-07 20:18:09)
转载▼</p>
<p>标签： 
it</p>
<p>首先要说明的是：
GNUStep 虽然可以在windows上安装使用但主要还是是面向Linux用户，而非Windows用户。如果有比较好的Linux开发经验，用GNUStep还是不错的。GNUStep的功能并不强，而且只有Foundation库，因此建议大家还是多花时间在 XCode 上比较划算的！
 
最近学习Objective-C，但是很穷用不起XCode。于是打算用GNUstep环境，命令行编译运行Objective-C文件。但是找了一些网上的教程，比较老了，而且都是相互copy。有些错误的地方都是传来传去。于是打算简单写一下正确的步骤。如果您有更好更简单更正确的方法，也请您留言，我将学习并改正。谢谢！
首先去http://www.gnustep.org/experience/Windows.html官网下载GNUstep的三件套。很多文章都是写的下载两个程序，其实现在GCC在第三个文件里了。仅仅前两个是不行的。
分别是GNUstep MSYS System、GNUstep Core、GNUstep Devel这三个工具。
下载好后安装，一路点击下去就可以了。
然后就可以使用了。程序-&gt;GNUstep-&gt;Shell。打开后等2秒就可以使用了。
给个例子吧：例如在F盘目录下用文本编辑一个文件Fraction.m，代码如下（最简单的Obj-C程序）：
 </p>
<h1>import &lt;Foundation/Foundation.h&gt;</h1>
<p>int main(int argc, char <em>argv[])  {  
  NSAutoreleasePool </em>pool = [[NSAutoreleasePool alloc] init];  
  NSLog(@"Hello world！");  
  [pool drain];  
  return 0;  
}  
 
首先在Shell输入 cd f: 切换到F盘目录，然后
在Shell中输入命令：gcc -fconstant-string-class=NSConstantString -c Fraction.m -I /GNUstep/System/Library/Headers
这是目录里就会生成一个Fraction.o文件。（成功完成此步骤不会有任何显示在命令行中，若有显示说明有错误）
接下来输入命令gcc -o Fraction Fraction.o -L /GNUstep/System/Library/Libraries/ -lobjc -lgnustep-base
此时成功的话就会在目录里生成一个Fraction.exe文件。
最后使用命令 ./Fraction.exe会看到输出的结果，我的结果是：2011-03-07 19:30:33.078 Fraction[4824] Hello world!
成功！</p>
            </div><!-- /.entry-content -->


        </div><!-- /.eleven.columns -->

<div class="three columns">
<h4>站内搜索</h4>
              <div class="navbar-search pull-right">
                <script type="text/javascript">(function(){document.write(unescape('%3Cdiv id="bdcs"%3E%3C/div%3E'));var bdcs = document.createElement('script');bdcs.type = 'text/javascript';bdcs.async = true;bdcs.src = 'http://znsv.baidu.com/customer_search/api/js?sid=8305292233022102519' + '&plate_url=' + encodeURIComponent(window.location.href) + '&t=' + Math.ceil(new Date()/3600000);var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(bdcs, s);})();</script>
              </div>    

<h4>页面</h4>

 <ul>
  </ul>

<h4>分类</h4>
<ul class="blank">
		<li><a href="/blog/category/android.html">android</a></li>
		<li><a href="/blog/category/api.html">api</a></li>
		<li><a href="/blog/category/essay.html">essay</a></li>
		<li><a href="/blog/category/git.html">git</a></li>
		<li><a href="/blog/category/go.html">go</a></li>
		<li><a href="/blog/category/hack.html">hack</a></li>
		<li><a href="/blog/category/ios.html">ios</a></li>
		<li><a href="/blog/category/java.html">java</a></li>
		<li><a href="/blog/category/javascript.html">javascript</a></li>
		<li><a href="/blog/category/linux.html">linux</a></li>
		<li><a href="/blog/category/mysql.html">mysql</a></li>
		<li><a href="/blog/category/operation.html">operation</a></li>
		<li><a href="/blog/category/others.html">others</a></li>
		<li><a href="/blog/category/php.html">php</a></li>
		<li><a href="/blog/category/program.html">program</a></li>
		<li><a href="/blog/category/python.html">python</a></li>
		<li><a href="/blog/category/read.html">read</a></li>
		<li><a href="/blog/category/soft.html">soft</a></li>
		<li><a href="/blog/category/success.html">success</a></li>
		<li><a href="/blog/category/test.html">test</a></li>
		<li><a href="/blog/category/vcs.html">vcs</a></li>
		<li><a href="/blog/category/windows.html">windows</a></li>
</ul>


<h4>标签</h4>


<nav class="widget">
  <h4>友情链接</h4>
  <ul class="blank">
    <li><a href="/">搜索</a></li>
    <li><a href="/123">导航</a></li>
    <li><a href="/doc">文档</a></li>
    <li><a href="/blog">博客</a></li>
  </ul>
</nav>

</div> </div><!-- /.row -->


</section>

       </div><!-- /.row -->
    </div><!-- /.container -->


       <div class="container.nopad bg">

    
        <footer id="credits" class="row">
          <div class="seven columns left-center">

                   <address id="about" class="vcard body">
                    Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                    which takes great advantage of <a href="http://python.org">Python</a>.
                    <br />
                    Based on the <a target="_blank" href="http://gumbyframework.com">Gumby Framework</a>
                    </address>
          </div>


          <div class="seven columns">
            <div class="row">
              <ul class="socbtns">





              </ul>
            </div>
          </div>
        </footer>

    </div>


  <script src="/blog/theme/js/libs/jquery-1.9.1.min.js"></script>
  <script src="/blog/theme/js/libs/gumby.min.js"></script>
  <script src="/blog/theme/js/plugins.js"></script>
</body>
</html>