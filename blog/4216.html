<!DOCTYPE html>
<html lang="zh_cn">
<head>

        <title>Objective-C 中类属性(修饰)</title>
        <meta charset="utf-8" />


        <!-- Mobile viewport optimized: j.mp/bplateviewport -->
        <meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1">

        <link rel="stylesheet" type="text/css" href="/blog/theme/gumby.css" />
        <link rel="stylesheet" type="text/css" href="/blog/theme/style.css" />
        <link rel="stylesheet" type="text/css" href="/blog/theme/pygment.css" />

        <script src="/blog/theme/js/libs/modernizr-2.6.2.min.js"></script>




</head>

<body id="index" class="home">


    <div class="container">

        <div class="row">

          <header id="banner" class="body">
                  <h1><a href="/blog/">逍遥の博客 <strong></strong></a></h1>
          </header><!-- /#banner -->

            <div id="navigation" class="navbar row">
              <a href="#" gumby-trigger="#navigation &gt; ul" class="toggle"><i class="icon-menu"></i></a>
             
              <ul class="columns">
                <li><a href="/blog/">首页</a></li>


              </ul>

            </div>

<section id="content" class="body">

   <div class="row">
        <div class="eleven columns">


            <header>
              <h2 class="entry-title">
                <a href="/blog/4216.html" rel="bookmark"
                   title="Permalink to Objective-C 中类属性(修饰)">Objective-C 中类属性(修饰)</a></h2>
           
            </header>
            <footer class="post-info">
              <abbr class="published" title="1970-01-01T00:00:00+08:00">
                Thu 01 January 1970
              </abbr>
              <address class="vcard author">By 
                <a class="url fn" href="/blog/author/u0mo5.html"> u0mo5</a>
              </address>
            </footer><!-- /.post-info -->
            <div class="entry-content">
              <p>Objective-C 中类属性(修饰)
 (2013-07-13 14:38:35)
转载▼</p>
<p>标签： 
it</p>
<p>分类： IOS笔记</p>
<p>nonatomic: 非原子性访问，对属性赋值的时候不加锁，多线程并发访问会提高性能。若不加此属性，则默认是两个访问方法都为原子型事务访问。（atomic是Objc使用的一种线程保护技术，基本上来讲，是防止在写未完成的时候被另外一个线程读取，造成数据错误。而这种机制是耗费系统资源的，所以在iPhone这种小型设备上，如果没有使用多线程间的通讯编程，那么nonatomic是一个非常好的选择。）assign: 简单赋值，不更改引用计数；        适用于基本数据类型（例如NSInteger）和C数据类型（int,float,double,char,等）以及指针的弱引用注：指针的弱引用，比如：delegate，在ARC模式中用weak比较好，在非ARC模式中用assign一、非ARC模式copy： 建立一个索引计数为1的对象，然后释放旧的对象retain： 释放旧的对象，将旧的对象的值赋予输入对象，在提高输入对象的索引计数为1例子：@interface MyClass:NSObject@property (nonatomic, copy) NSString <em>myString;这里定义了一个NSString类型的属性，不需要原子操作，所以用nonatomic.为什么需要copy，而不是retain呢！ 因为如果对myString赋值原字符串是一个可变的字符串(NSMutableString)对象的话，用retain的话，当原字符串改变的时候你的myString属性也会跟着变掉。我想你不希望看到这个现象。@property (nonatomic, retain) UIView </em>myView;这里定义了一个UIView类型的属性，不需要原子操作，所以用nonatomic.当对myView 赋值的时候原来的UIView对象retainCount会加1@implementation MyClass@synthesize myString;@synthesize myView;</p>
<p>创建一个MyClass的对象MyClass <em>object=[[MyClass alloc] init];NSMutableString </em>mutString=[NSMutableString stringWithString:"hello"];object.myString=mutString;[mutString appendString:@"world!"];NSLog(@"%@",mutString); 输出为“hello world!”；NSLog(@"%@",object.myString); 输出为"hello"，因为myString在mutString改变之前已经copy了一份副本UIView <em>view=[[UIView alloc] init];view的retainCount为1；object.myView=view;此时view的retainCount为2，因为myView对View进行了一次retain。[view release];此处虽然view被release释放掉了，但是myView对view进行了一次retain，那么myView保留的UIView的对象指针仍然有效。[object release];二、ARC模式 iOS中的ARC是随着xcode4.2一起引入的，4.2版本以前的xcode是没有这种特性的，ARC只能在iOS4 和iOS5上使用，而weak关键字只能在iOS5上使用，并且只能是工程在ARC管理内存的时候才能用。        前段时间看到别人的代码中出现了unsafe_unretained的关键字，虽然自己了解它是出自arc中的关键字，但是为了了解的更加透彻，所以上网收集了一些相关知识来记录一下，以备以后查阅；先 来了解一下各个关键字之间的关系，和其是否拥有所有权(及保留)属性值关键字所有权strong __strong有weak__weak无unsafe_unretained__unsafe_unretained无copy__strong有 assign__unsafe_unretained无retain__strong有
strong该属性值对应 __strong 关键字，即该属性所声明的变量将成为对象的持有者。
weak该属性对应 __weak 关键字,与 __weak 定义的变量一致,该属性所声明的变量将没有对象的所有权，并且当对象被破弃之后,对象将被自动赋值nil。并且,delegate 和 Outlet 应该用 weak 属性来声明。同时,iOS 5 之前的版本是没有 __weak 关键字的,所以 weak 属性是不能使用的。这种情况我们使用 unsafe_unretained。
unsafe_unretained等效于__unsafe_unretaind关键字声明的变量;像上面说明的，iOS 5之前的系统用该属性代替 weak 来使用。(这里需要说明一下:应尽量不要使用unsafe_unretained来声明属性，因为如果它所指向的对象被释放了，那么它将变成一个野指针，而不会是nil，如果程序试图访问该野指针就会造成crash)
copy与 strong 的区别是声明变量是拷贝对象的持有者。
assign一般Scalar Varible用该属性声明，比如,int, BOOL。
retain该属性与 strong 一致;只是可读性更强一些。
读写相关的属性 (readwrite, readonly)读写相关的属性有 readwrite 和 readonly 两种，如果使用ARC之后，我么需要注意一下 readonly 属性的使用。
比如下面的变量声明。@property (nonatomic, readonly) NSString </em>name;一般声明为 readonly 的变量按理说应该不需要持有所有权了，但是在ARC有效的情况下，将出现下面的错误信息 ：“ARCforbidssynthesizingapropertyofanObjective-C object with unspecified ownership or storage attribute 如果定义了ARC有效，那么必须要有所有者属性的定义;所以我们的代码改成这样，就OK了@property (nonatomic, strong, readonly) NSString *name;不过有一点，Scalar Varible的变量缺省都有 assign 的属性定义，所以不需要给他们单独的明示声明了。
有一个关键字需要特别注意一下，就是__autoreleasing在没有开启ARC的情况下，我们可以在一个函数中使用autorelease让某个对象延迟释放，但是在开启ARC的情况下是不会通过编译，如下:</p>
<p>-(ClassA <em>)TestMethod{ ClassA </em>classA = [[ClassA alloc] init]; return [classA autorelease];}
在开启ARC的情况下，我们就需要使用如下方式进行替代:</p>
<p>-(ClassA <em>)TestMethod{ __autoreleasing ClassA </em>classA = [ClassA alloc] init]; return classA;}
或:</p>
<p>-(NSString <em>)TestMethod:(_autoreleasing ClassA </em>)classA{ classA = [[ClassA alloc] init]; return classA;}ARC机制让我们节省了很多代码的编写，并且也让程序在效率方面有了很大的提升，所以充分利用这个新特性对我们是非常有帮助的，但是不建议新手使用，因为它会让我们知其然而不知其所以然。</p>
            </div><!-- /.entry-content -->


        </div><!-- /.eleven.columns -->

<div class="three columns">
<h4>站内搜索</h4>
              <div class="navbar-search pull-right">
                <script type="text/javascript">(function(){document.write(unescape('%3Cdiv id="bdcs"%3E%3C/div%3E'));var bdcs = document.createElement('script');bdcs.type = 'text/javascript';bdcs.async = true;bdcs.src = 'http://znsv.baidu.com/customer_search/api/js?sid=8305292233022102519' + '&plate_url=' + encodeURIComponent(window.location.href) + '&t=' + Math.ceil(new Date()/3600000);var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(bdcs, s);})();</script>
              </div>    

<h4>页面</h4>

 <ul>
  </ul>

<h4>分类</h4>
<ul class="blank">
		<li><a href="/blog/category/android.html">android</a></li>
		<li><a href="/blog/category/api.html">api</a></li>
		<li><a href="/blog/category/essay.html">essay</a></li>
		<li><a href="/blog/category/git.html">git</a></li>
		<li><a href="/blog/category/go.html">go</a></li>
		<li><a href="/blog/category/hack.html">hack</a></li>
		<li><a href="/blog/category/ios.html">ios</a></li>
		<li><a href="/blog/category/java.html">java</a></li>
		<li><a href="/blog/category/javascript.html">javascript</a></li>
		<li><a href="/blog/category/linux.html">linux</a></li>
		<li><a href="/blog/category/mysql.html">mysql</a></li>
		<li><a href="/blog/category/operation.html">operation</a></li>
		<li><a href="/blog/category/others.html">others</a></li>
		<li><a href="/blog/category/php.html">php</a></li>
		<li><a href="/blog/category/program.html">program</a></li>
		<li><a href="/blog/category/python.html">python</a></li>
		<li><a href="/blog/category/read.html">read</a></li>
		<li><a href="/blog/category/soft.html">soft</a></li>
		<li><a href="/blog/category/success.html">success</a></li>
		<li><a href="/blog/category/test.html">test</a></li>
		<li><a href="/blog/category/vcs.html">vcs</a></li>
		<li><a href="/blog/category/windows.html">windows</a></li>
</ul>


<h4>标签</h4>


<nav class="widget">
  <h4>友情链接</h4>
  <ul class="blank">
    <li><a href="/">搜索</a></li>
    <li><a href="/123">导航</a></li>
    <li><a href="/doc">文档</a></li>
    <li><a href="/blog">博客</a></li>
  </ul>
</nav>

</div> </div><!-- /.row -->


</section>

       </div><!-- /.row -->
    </div><!-- /.container -->


       <div class="container.nopad bg">

    
        <footer id="credits" class="row">
          <div class="seven columns left-center">

                   <address id="about" class="vcard body">
                    Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                    which takes great advantage of <a href="http://python.org">Python</a>.
                    <br />
                    Based on the <a target="_blank" href="http://gumbyframework.com">Gumby Framework</a>
                    </address>
          </div>


          <div class="seven columns">
            <div class="row">
              <ul class="socbtns">





              </ul>
            </div>
          </div>
        </footer>

    </div>


  <script src="/blog/theme/js/libs/jquery-1.9.1.min.js"></script>
  <script src="/blog/theme/js/libs/gumby.min.js"></script>
  <script src="/blog/theme/js/plugins.js"></script>
</body>
</html>