<!DOCTYPE html>
<html lang="zh_cn">
<head>

        <title>如何运维能让网站稳定高效--稳定篇</title>
        <meta charset="utf-8" />


        <!-- Mobile viewport optimized: j.mp/bplateviewport -->
        <meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1">

        <link rel="stylesheet" type="text/css" href="/blog/theme/gumby.css" />
        <link rel="stylesheet" type="text/css" href="/blog/theme/style.css" />
        <link rel="stylesheet" type="text/css" href="/blog/theme/pygment.css" />

        <script src="/blog/theme/js/libs/modernizr-2.6.2.min.js"></script>




</head>

<body id="index" class="home">


    <div class="container">

        <div class="row">

          <header id="banner" class="body">
                  <h1><a href="/blog/">逍遥の博客 <strong></strong></a></h1>
          </header><!-- /#banner -->

            <div id="navigation" class="navbar row">
              <a href="#" gumby-trigger="#navigation &gt; ul" class="toggle"><i class="icon-menu"></i></a>
             
              <ul class="columns">
                <li><a href="/blog/">首页</a></li>


              </ul>

            </div>

<section id="content" class="body">

   <div class="row">
        <div class="eleven columns">


            <header>
              <h2 class="entry-title">
                <a href="/blog/4144.html" rel="bookmark"
                   title="Permalink to 如何运维能让网站稳定高效--稳定篇">如何运维能让网站稳定高效--稳定篇</a></h2>
           
            </header>
            <footer class="post-info">
              <abbr class="published" title="1970-01-01T00:00:00+08:00">
                Thu 01 January 1970
              </abbr>
              <address class="vcard author">By 
                <a class="url fn" href="/blog/author/u0mo5.html"> u0mo5</a>
              </address>
            </footer><!-- /.post-info -->
            <div class="entry-content">
              <p>如何运维能让网站稳定高效--稳定篇
 </p>
<p>浏览：50 发布日期：2015/08/13 分类：技术分享</p>
<p>本文由 Alan 投稿作为一名运维工程师，工作中最大的希望就是自己运维的网站能够稳定高效运行，但理想很丰满现实很骨感，实际情况是总会有各种各样状况导致网络、服务器或者应用环境发生故障。面对这种情况，我觉得还是要能从故障中总结出经验规律，让发生的几率不断的降低。要完成稳定和高效两者中的任何一个都是一个极具挑战的事情，这里我以维护自己的blog为例来阐述一下我对稳定这个词的诠释和理解。我的Blog架设在wordpress环境上的，记录了工作中的一些经验总结和随笔文章，虽然是个人网站，但麻雀虽小，五脏俱全，有一定的代表性。一． 稳定之硬件稳定硬件是基础设施，必须打好硬件稳定的基础。传统的硬件选型一般都是购买HP，DELL的机架式服务器，根据自己的需求选择CPU，内存，硬盘等，这种方式有一个弊端就是不能很方便的对硬件进行后期扩容，买了后一般情况下就定型了，而且还要托管，购买带宽，后期的硬件维护也是需要自己来做。面对这些问题，我觉得选择当下比较炙手可热的云服务器是个不错的选择。它解决了：1） 硬件型号不再重要，自然也就不会成为网站发展的瓶颈，CPU，内存，硬盘等硬件的大小都是弹性的，根据自己使用的情况随时可以增大和减小2） 云服务器提供商提供托管场地和网络带宽设施3） 因为云服务器提供商一般都有大量的服务器，所以会专门有一个机房工程师每天做硬件，网络的巡检工作，及时发现问题并将基础问题处理在萌芽阶段4） 对磁盘IO要求比较高的，可以选择购买本地磁盘和SSD磁盘来解决问题总的来说，选择云服务器比较省心，而且国内的云服务器也逐渐的成熟起来，我个人使用云服务器这种方式7个月了，截止目前，硬件，网络都没有出现过问题，还是比较稳定的。当然大型云服务器提供商是比较好的选择，阿里云、腾讯云、Ucloud都不错。具体选择哪家，可以根据自己的实际情况来酌情选择。二． 稳定之软件稳定软件是具体提供服务的应用组件，要做好这个稳定我觉得比硬件难一些了，方方面面都要考虑清楚，这里从下往上来逐个分析吧：1）Wordpress是一个PHP环境的程序，那么Linux作为系统环境就是一个很好的选择，其实稳定的另一个特征就是当出现了故障时能够很快的排除故障，在成百上千的Linux发布系统中很多人最终选择Redhat，CentOS肯定是有其原因的，CentOS是基于企业级linux系统发布Redhat编译而来，兼容性好而且免费使用，网络中有大量的技术文章可以借阅参考，64位也会逐渐的取代32位系统，我最后选择的是CentOS6 64位系统环境。这里不是说让大家全部选择此发行版，而是一个建议，在实际选择过程中最好根据自己的业务类型，选择一个能用上3到5年的系统，不折腾。2）nginx、mysql、php的搭档组合有逐步取代AMP组合的趋势，V1.0以上的nginx，V5.1以上的mysql，V5.4以上的PHP，这个版本选择是目前比较实用的组合，能够支撑一段时间不需要在更新了。3）组件选择好后，比较关键的就是配置好这些组件了，配置这个过程没有一个统一的标准，需要不同参数也就不同，但不管环境怎样，还是有几个比较通用的法则：A． 一个PHP和nginx进程大约占用内存20M，最大允许的进程数是要根据自己的实际内存大小来动态调整，否则可能导致内存耗尽而系统崩溃B．调整参数的原则就是让自己的硬件资源能够充分利用，最大使用率根据28原则C．配置的过程是一个循序渐进的过程，很多时候也是在处理问题时逐步总结出来最优配置三． 稳定之实时监控网站对外发布后，剩下的任务就是要保证网站不出故障，持久稳定运行了。要做到这一点，就要对网站和硬件的运行情况有一个全面的了解才可以。掌握的数据越多，就对自己的网站运行情况越有利。可用性监控：网站当下是否能够正常访问，这是一个最基本的要求。但我们不可能实时去盯着，这里需要有个实时监控的服务去不断的探测，提供这样服务的工具有很多，例如nagios，zabbix等开源产品就是专门做这个事情的，周期性的探测网站的可用性，不过这种产品有一个很大的局限性，就是nagios和zabbix是部署在和自己网站同样的网络环境中，常常会出现nagios探测是好的，但外部访问却不行的状况。这里我选择了一个第三方公司的产品——云智慧的监控宝，来做我的blog的可用性监控，其实现原理是使用它在全世界托管的监测服务器来周期性的访问我的blog，这种监控比较接近于实际用户访问，比较有说服力，如果发现了问题，会有一个告警信息发送到手机、邮件上。图1图2四. 稳定之压力测试压力测试的目的是为了能够对自己网站的最大负载能力有一个预估值,原则是测试一个有复杂业务逻辑的动态页面为好,通过压力测试得出自己网站的最大并发值和承载能力。得出这个值之后，剩下的在配置参数的时候就有依据了。压力测试的方法有很多种，比较常见的有ab，loadrunnner等工具。五．稳定之硬件资源使用监控和并发数监控压力测试的目的就是为了能够在这一环节有的放矢，网站上线后通过可用性监控得知网站是否能正常访问。在通过硬件资源使用情况和web服务的并发数监控，在监控中将告警阀值设置为压力测试过程中的80%为准。通过这样的实时监控，就对自己的服务器的运行情况有一个立体式的掌控，让其能够运行在正常的区间中。总结：保证服务的稳定是一个持续的过程，通过时间的积累对自己维护的业务运行情况越来越熟悉，对架构的掌握也越来越透彻，将网站架构中的薄弱环节加固，再通过后期的实时监控，对网站的整体运行情况有一个清晰的认识，由此来让自己运维的网站稳定运行。以上五点算是抛砖引玉吧，如果你有好的方法，随时沟通交流：wxd5981@163.com监控宝官网：www.jiankongbao.com</p>
            </div><!-- /.entry-content -->


        </div><!-- /.eleven.columns -->

<div class="three columns">
<h4>站内搜索</h4>
              <div class="navbar-search pull-right">
                <script type="text/javascript">(function(){document.write(unescape('%3Cdiv id="bdcs"%3E%3C/div%3E'));var bdcs = document.createElement('script');bdcs.type = 'text/javascript';bdcs.async = true;bdcs.src = 'http://znsv.baidu.com/customer_search/api/js?sid=8305292233022102519' + '&plate_url=' + encodeURIComponent(window.location.href) + '&t=' + Math.ceil(new Date()/3600000);var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(bdcs, s);})();</script>
              </div>    

<h4>页面</h4>

 <ul>
  </ul>

<h4>分类</h4>
<ul class="blank">
		<li><a href="/blog/category/android.html">android</a></li>
		<li><a href="/blog/category/api.html">api</a></li>
		<li><a href="/blog/category/essay.html">essay</a></li>
		<li><a href="/blog/category/git.html">git</a></li>
		<li><a href="/blog/category/go.html">go</a></li>
		<li><a href="/blog/category/hack.html">hack</a></li>
		<li><a href="/blog/category/ios.html">ios</a></li>
		<li><a href="/blog/category/java.html">java</a></li>
		<li><a href="/blog/category/javascript.html">javascript</a></li>
		<li><a href="/blog/category/linux.html">linux</a></li>
		<li><a href="/blog/category/mysql.html">mysql</a></li>
		<li><a href="/blog/category/operation.html">operation</a></li>
		<li><a href="/blog/category/others.html">others</a></li>
		<li><a href="/blog/category/php.html">php</a></li>
		<li><a href="/blog/category/program.html">program</a></li>
		<li><a href="/blog/category/python.html">python</a></li>
		<li><a href="/blog/category/read.html">read</a></li>
		<li><a href="/blog/category/soft.html">soft</a></li>
		<li><a href="/blog/category/success.html">success</a></li>
		<li><a href="/blog/category/test.html">test</a></li>
		<li><a href="/blog/category/vcs.html">vcs</a></li>
		<li><a href="/blog/category/windows.html">windows</a></li>
</ul>


<h4>标签</h4>


<nav class="widget">
  <h4>友情链接</h4>
  <ul class="blank">
    <li><a href="/">搜索</a></li>
    <li><a href="/123">导航</a></li>
    <li><a href="/doc">文档</a></li>
    <li><a href="/blog">博客</a></li>
  </ul>
</nav>

</div> </div><!-- /.row -->


</section>

       </div><!-- /.row -->
    </div><!-- /.container -->


       <div class="container.nopad bg">

    
        <footer id="credits" class="row">
          <div class="seven columns left-center">

                   <address id="about" class="vcard body">
                    Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                    which takes great advantage of <a href="http://python.org">Python</a>.
                    <br />
                    Based on the <a target="_blank" href="http://gumbyframework.com">Gumby Framework</a>
                    </address>
          </div>


          <div class="seven columns">
            <div class="row">
              <ul class="socbtns">





              </ul>
            </div>
          </div>
        </footer>

    </div>


  <script src="/blog/theme/js/libs/jquery-1.9.1.min.js"></script>
  <script src="/blog/theme/js/libs/gumby.min.js"></script>
  <script src="/blog/theme/js/plugins.js"></script>
</body>
</html>